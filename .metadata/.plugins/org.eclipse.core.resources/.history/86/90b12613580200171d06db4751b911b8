package com.iphone567.demo;

import java.lang.reflect.Method;

import com.iphone567.annotation.MyTest;

@SuppressWarnings("all")
public class Main {

	public static void main(String[] args)
			throws Exception {
		Method[] methods = Demo.class.getMethods();
		for (Method method : methods) {
			// 判断当前方法是否有@MyTest修饰
			boolean annotationPresent = method.isAnnotationPresent(MyTest.class);
			if (annotationPresent) {
				// 拿到Annotation注解
				MyTest mytest = (MyTest) method.getAnnotation(MyTest.class);
				Object newInstance = Demo.class.newInstance();
				// 注解默认的timeout属性值是-1，大于0代表是默认值，直接执行方法即可。
				if(mytest.timeout() < 0) {
					method.invoke(newInstance, null);
				} else {
					long s = System.nanoTime();
					method.invoke(newInstance, null);
					long e = System.nanoTime();
					if((e-s) > mytest.timeout()) {
						System.out.println(method.getName() + "执行超时！");
					}
				}
				
				
			}
		}
	}

}
